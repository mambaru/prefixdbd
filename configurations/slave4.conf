{
    "startup":{},

    "config": {
        "enabled": true,
        "reload_changed_ms": 0,
        "reload_sighup": false
    },

    "core": {
        "rlimit_as_mb": 0,
        "enable_callback_check": true,
        "core_timeout_ms": 1000,
        "idle_timeout_ms": 1000,
        "core-workflow": {
            "threads": 1,
            "use_io_service": false,
            "maxsize": 10000,
            "wrnsize": 10
        }
    },

    "logger": {
        "enabled": true,
        "startup_priority": -1000,
        "shutdown_priority": 1000,
        "milliseconds": true,
        "single": true,
        "limit": 10000000,
        "path": "/logs/prefixdb-slave4",
        "stdout": "cout",
        "syslog": "",
        "deny": [],
        "custom": {}
    },

    "workflow": [
        {
            "enabled": true,
            "name": "server-workflow",
            "startup_priority": 0,
            "shutdown_priority": 0,

            "threads": 6,
            "use_io_service": false,
            "post_delay_ms": 0,
            "rate_limit": 0,
            "maxsize": 134217728,
            "wrnsize": 1048576
        },
        {
            "enabled": true,
            "name": "client-workflow",
            "startup_priority": 0,
            "shutdown_priority": 0,

            "threads": 2,
            "use_io_service": false,
            "post_delay_ms": 0,
            "rate_limit": 0,
            "maxsize": 134217728,
            "wrnsize": 1048576
        }
    ],

    "prefixdb": [
        {
            "enabled": true,
            "name": "prefixdb1",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "suspend": false,

            "path": "/monamour/prefixdb/slave4",
            "detach_path": "/monamour/prefixdb/slave4_detach",
            "ini": "./prefixdb.ini",
            "preopen": true,
            "auto_repair": false,
            "abort_if_open_error": true,
            "stop_list": [],
            "workflow": "",

            "enable_delayed_write": true,
            "key_size_limit": 256,
            "keys_per_req": 100,
            "array_limit": 1000,
            "packed_limit": 1000,
            "prefix_size_limit": 256,
            "max_prefixes": 128,
            "range_limit": 10000,
            "value_size_limit": 10240,

            "slave": {
                "enabled": true,
                "target": "prefixdb-gateway1",

                "start_time": "",
                "pull_timeout_ms": 1000,
                "query_prefixes_timeout_ms": 60000,

                "acceptable_loss_seq": 0,
                "enable_progress": false,
                "expires_for_req": true,
                "log_limit_per_req": 1500,
                "seq_log_timeout_ms": 60000,

                "wrn_log_diff_seq": 1000,
                "wrn_log_timeout_ms": 1000
            },

            "backup": {
                "enabled": true,
                "path": "/monamour/prefixdb/slave4_backup",
                "depth": 12,
                "period_s": 600,
                "start_delay_s": 0,
                "start_time": ""
            },
            
            "archive": {
                "enabled": true, 
                "depth": 1, 
                "path": "/monamour/prefixdb/slave4_archive", 
                "period_s": 0, 
                "start_time": "05:00:00"
            }
        }
    ],

    "prefixdb-service": [
        {
            "enabled": true,
            "name": "prefixdb-service1",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "suspend": false,

            "target": "prefixdb1",
            "workflow": "",
            "allow_non_jsonrpc": true,
            "remove_everytime": true,
            "call_lifetime_ms": 3000,
            "remove_outdated_ms": 1000
        }
    ],
    
    "prefixdb-gateway": [
        {
            "enabled": true,
            "name": "prefixdb-gateway1",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "suspend": false,
            "workflow": "",

            "outgoing_reg": true,
            "outgoing_target": "client-queue",
            "incoming_reg": false,
            "incoming_target": "",

            "allow_non_jsonrpc": false,
            "call_lifetime_ms": 60000,
            "remove_everytime": true,
            "remove_outdated_ms": 1000
        }
    ],

    "jsonrpc-queue": [
        {
            "enabled": true,
            "name": "server-queue",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "suspend": false,

            "target": "prefixdb-service1",
            "workflow": "server-workflow",
            "callback_queue": false,
            "callback_workflow": ""
        },
        {
            "enabled": true,
            "name": "client-queue",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "suspend": false,

            "target": "client-tcp1",
            "workflow": "client-workflow",
            "callback_queue": false,
            "callback_workflow": ""
        }
    ],

    "server-tcp": [
        /* Основной порт*/
        {
            "enabled": true,
            "name": "main-tcp",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "suspend": false,

            "target": "server-queue",
            "addr": "0.0.0.0",
            "port": "23520",
            "threads": 1,
            "backlog": 1024,
            "max_connections": 0,
            "workflow": "",
            "connection": {
                "keep_alive": true,
                "reader": {
                    "sep": "\r\n",
                    "bufsize": 4096,
                    "maxbuf": 8192,
                    "minbuf": 0,
                    "trimsep": true
                },
                "writer": {
                    "sep": "\r\n",
                    "bufsize": 8192,
                    "maxbuf": 8192,
                    "minbuf": 0,
                    "first_as_is": true
                }
            }
        }
    ],
    
    "client-tcp": [
        {
            "enabled": true,
            "name": "client-tcp1",
            "startup_priority": 0,
            "shutdown_priority": 0,
            "workflow": "",

            "addr": "cdaemon9",
            "port": "23502",
            "threads": 2,
            "connect_count": 2,
            "reconnect_timeout_ms": 2000,
            "async_connect": true,

            "connection": {
                "keep_alive": true,
                "reader": {
                    "bufsize": 4096,
                    "maxbuf": 8192,
                    "minbuf": 0,
                    "sep": "\r\n",
                    "trimsep": true
                },
                "writer": {
                    "bufsize": 8192,
                    "first_as_is": true,
                    "maxbuf": 8192,
                    "minbuf": 0,
                    "sep": "\r\n"
                }
            }
        }
    ]

}
